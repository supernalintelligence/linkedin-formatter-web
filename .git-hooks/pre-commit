#!/bin/bash

# Pre-commit hook for linkedin-formatter-web
# Ensures TypeScript builds cleanly before committing

set -e

echo "ğŸ”’ Pre-commit: Checking linkedin-formatter-web..."

# Change to the app directory
cd "$(git rev-parse --show-toplevel)/families/supernal-social/apps/linkedin-formatter-web"

# Check if package.json exists
if [ ! -f "package.json" ]; then
    echo "âš ï¸  Skipping: Not in linkedin-formatter-web directory"
    exit 0
fi

# Run TypeScript check
echo "ğŸ“ Running TypeScript check..."
if ! pnpm exec tsc --noEmit; then
    echo "âŒ TypeScript errors found. Please fix before committing."
    exit 1
fi

echo "âœ… TypeScript check passed!"

# Optional: Run build to ensure it compiles
echo "ğŸ”¨ Running build check..."
if ! pnpm build; then
    echo "âŒ Build failed. Please fix before committing."
    exit 1
fi

echo "âœ… Build check passed!"

exit 0

